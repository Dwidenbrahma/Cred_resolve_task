# ğŸ“ Visual System Architecture & Diagrams

## System Architecture Visualization

### Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT LAYER                              â”‚
â”‚              (Web Browser | Mobile App | API Client)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    HTTP/REST Protocol
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Load Balancer  â”‚ (Optional)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EXPRESS SERVER 1 â”‚ â”‚ EXPRESS SERVER 2 â”‚ â”‚ EXPRESS SERVER 3 â”‚
â”‚  (Node.js)       â”‚ â”‚  (Node.js)       â”‚ â”‚  (Node.js)       â”‚
â”‚                  â”‚ â”‚                  â”‚ â”‚                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ app.ts       â”‚ â”‚ â”‚ â”‚ app.ts       â”‚ â”‚ â”‚ â”‚ app.ts       â”‚ â”‚
â”‚ â”‚ Middleware   â”‚ â”‚ â”‚ â”‚ Middleware   â”‚ â”‚ â”‚ â”‚ Middleware   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚         â”‚ â”‚        â”‚         â”‚ â”‚        â”‚         â”‚
â”‚        â–¼         â”‚ â”‚        â–¼         â”‚ â”‚        â–¼         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ROUTES       â”‚ â”‚ â”‚ â”‚ ROUTES       â”‚ â”‚ â”‚ â”‚ ROUTES       â”‚ â”‚
â”‚ â”‚ /users       â”‚ â”‚ â”‚ â”‚ /users       â”‚ â”‚ â”‚ â”‚ /users       â”‚ â”‚
â”‚ â”‚ /groups      â”‚ â”‚ â”‚ â”‚ /groups      â”‚ â”‚ â”‚ â”‚ /groups      â”‚ â”‚
â”‚ â”‚ /expenses    â”‚ â”‚ â”‚ â”‚ /expenses    â”‚ â”‚ â”‚ â”‚ /expenses    â”‚ â”‚
â”‚ â”‚ /balances    â”‚ â”‚ â”‚ â”‚ /balances    â”‚ â”‚ â”‚ â”‚ /balances    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                           â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ CONTROLLERS LAYER                                       â”‚     â”‚
â”‚ â”‚ â”œâ”€ userController                                     â”‚     â”‚
â”‚ â”‚ â”œâ”€ groupController                                    â”‚     â”‚
â”‚ â”‚ â”œâ”€ expenseController    â˜… Core business logic         â”‚     â”‚
â”‚ â”‚ â”œâ”€ balanceController                                  â”‚     â”‚
â”‚ â”‚ â””â”€ settlementController                               â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚        â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ SERVICES LAYER                                            â”‚ â”‚
â”‚ â”‚ â”œâ”€ userService                                            â”‚ â”‚
â”‚ â”‚ â”œâ”€ groupService                                           â”‚ â”‚
â”‚ â”‚ â”œâ”€ expenseService    â˜… Updates balances intelligently    â”‚ â”‚
â”‚ â”‚ â”œâ”€ balanceService    â˜… Core algorithm here              â”‚ â”‚
â”‚ â”‚ â””â”€ settlementService â˜… Handles settlements              â”‚ â”‚
â”‚ â”‚                                                           â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚ â”‚ â”‚ UTILS LAYER (Pure Functions)                        â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â”œâ”€ calculateSplit(EQUAL|EXACT|PERCENT)             â”‚  â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€ No side effects, fully testable                 â”‚  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â”‚                                                           â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚ â”‚ â”‚ CONFIG LAYER                                        â”‚  â”‚ â”‚
â”‚ â”‚ â””â”€ connectDB() â†’ MongoDB connection                  â”‚  â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MODELS LAYER (Mongoose Schemas)                           â”‚ â”‚
â”‚ â”‚ â”œâ”€ User     {name, email, timestamps}                    â”‚ â”‚
â”‚ â”‚ â”œâ”€ Group    {groupName, members[], timestamps}           â”‚ â”‚
â”‚ â”‚ â”œâ”€ Expense  {title, amount, splits, participants...}     â”‚ â”‚
â”‚ â”‚ â””â”€ Balance  {fromUser, toUser, amount}  â˜… Optimized     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ MongoDB Wire Protocol
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          MONGODB DATABASE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Collections:                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ â”‚ Users           â”‚   {_id, name, email}            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ â”‚ Groups          â”‚   {_id, name, members[]}        â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ â”‚ Expenses        â”‚   {_id, groupId, splits..}      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚ â”‚ Balances        â”‚   {_id, fromUser, toUser, amt}  â”‚
â”‚ â”‚ UNIQUE INDEX    â”‚   (groupId, fromUser, toUser)   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Routing Structure

```
ROOT
â”‚
â”œâ”€ /users
â”‚  â”œâ”€ POST    /        (Create user)
â”‚  â””â”€ GET     /        (List users)
â”‚
â”œâ”€ /groups
â”‚  â”œâ”€ POST    /        (Create group)
â”‚  â”œâ”€ GET     /:id     (Get group details)
â”‚  â””â”€ POST    /:id/add-member  (Add member)
â”‚
â”œâ”€ /expenses
â”‚  â”œâ”€ POST    /        (Create expense with splits)
â”‚  â””â”€ GET     /:groupId (Get expenses by group)
â”‚
â”œâ”€ /balances
â”‚  â””â”€ GET     /:groupId (Get all balances in group)
â”‚
â””â”€ /settlements
   â””â”€ POST    /        (Settle a debt)
```

---

## Request-Response Flow Diagram

### Single Request Lifecycle

```
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ CLIENT MAKES REQUEST                                       â•‘
  â•‘ POST /expenses with JSON body                              â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Express receives request
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ MIDDLEWARE PROCESSING                                      â•‘
  â•‘ â€¢ bodyParser extracts JSON                                 â•‘
  â•‘ â€¢ CORS validates origin                                    â•‘
  â•‘ â€¢ express.json() parses payload                            â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Route matches
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ ROUTE HANDLER                                              â•‘
  â•‘ POST /expenses â†’ expenseController.addExpense(req, res)    â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Controller processes
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ CONTROLLER                                                 â•‘
  â•‘ â€¢ Extract body data                                        â•‘
  â•‘ â€¢ Validate types                                           â•‘
  â•‘ â€¢ Call service layer                                       â•‘
  â•‘ â€¢ Catch errors                                             â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Call service
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ SERVICE LAYER                                              â•‘
  â•‘ â€¢ addExpense(data)                                         â•‘
  â•‘   â”œâ”€ Validate group                                        â•‘
  â•‘   â”œâ”€ Validate participants                                 â•‘
  â•‘   â”œâ”€ Create expense                                        â•‘
  â•‘   â”œâ”€ Calculate splits (utils)                              â•‘
  â•‘   â””â”€ Update balances                                       â•‘
  â•‘       â”œâ”€ Query existing balances                           â•‘
  â•‘       â”œâ”€ Apply optimization algorithm                      â•‘
  â•‘       â””â”€ Update/create balance                             â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Database operations
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ DATABASE LAYER (Mongoose)                                  â•‘
  â•‘ â€¢ Validate against schema                                  â•‘
  â•‘ â€¢ Execute MongoDB commands                                 â•‘
  â•‘ â€¢ Return results                                           â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Return to service
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ RESPONSE PREPARATION                                       â•‘
  â•‘ â€¢ Format results                                           â•‘
  â•‘ â€¢ Set status code (201)                                    â•‘
  â•‘ â€¢ Add headers                                              â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                   â”‚
                   â–¼ Send to client
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘ CLIENT RECEIVES RESPONSE                                   â•‘
  â•‘ HTTP 201 Created with JSON data                            â•‘
  â•‘ New expense recorded                                       â•‘
  â•‘ Balances automatically updated!                            â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Data Relationship Diagram

```
                    â•”â•â•â•â•â•â•â•â•â•â•—
                    â•‘  GROUP  â•‘
                    â•‘ (Group) â•‘
                    â•šâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â•
                         â”‚
                    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                â”‚
                    â–¼                â–¼
            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
            â•‘  EXPENSE       â•‘  â•‘  MEMBER REFS  â•‘
            â•‘  (Expense)     â•‘  â•‘  User array   â•‘
            â•‘                â•‘  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â•‘ â€¢ groupId â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â•‘ â€¢ paidBy â”€â”€â”
            â•‘ â€¢ amount   â”‚
            â•‘ â€¢ splits   â”‚
            â•‘ â€¢ part.    â”‚
            â•šâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘  USER          â•‘ (Participant)
        â•‘ (User)         â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
            â•‘  BALANCE            â•‘
            â•‘ (Balance)           â•‘
            â•‘                     â•‘
            â•‘ â€¢ groupId â”€â”€â”       â”‚
            â•‘ â€¢ fromUser â”€â”¤â”€â”€â–º USER (who owes)
            â•‘ â€¢ toUser â”€â”€â”€â”¤â”€â”€â–º USER (receives)
            â•‘ â€¢ amount    â”‚
            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEY RELATIONSHIPS:
1 User â†â†’ many Expenses (as paidBy)
1 User â†â†’ many Expenses (as participant)
1 User â†â†’ many Balances (as fromUser)
1 User â†â†’ many Balances (as toUser)
1 Group â†â†’ many Expenses
1 Group â†â†’ many Balances
```

---

## Balance Optimization Algorithm Flowchart

```
                    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
                    â•‘  updateBalance()                        â•‘
                    â•‘  Called when adding expense participant â•‘
                    â•šâ•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Input:                      â”‚
                    â”‚ â€¢ groupId                   â”‚
                    â”‚ â€¢ fromUser (who owes)       â”‚
                    â”‚ â€¢ toUser (who receives)     â”‚
                    â”‚ â€¢ amount                    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ QUERY: Same direction?   â”‚
                    â”‚ {groupId, fromUser,      â”‚
                    â”‚  toUser}                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                      YES   â”‚          â”‚  NO
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”    â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ADD to   â”‚    â”‚ QUERY: Reverse dir?  â”‚
                    â”‚ existing â”‚    â”‚ {groupId, toUser,    â”‚
                    â”‚ balance  â”‚    â”‚  fromUser}           â”‚
                    â”‚          â”‚    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                    â”‚ existing â”‚       â”‚  YES   â”‚  NO  â”‚ (No balance)
                    â”‚.amount   â”‚       â”‚        â”‚      â”‚
                    â”‚+= amount â”‚   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          â”‚   â”‚ COMPARE:    â”‚  â”‚ CREATE new balance â”‚
                    â”‚ save()   â”‚   â”‚ existing    â”‚  â”‚ {groupId,          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ amount vs   â”‚  â”‚  fromUser,         â”‚
                                   â”‚ new amount  â”‚  â”‚  toUser,           â”‚
                                   â””â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚  amount}           â”‚
                          GREATER â”‚  â”‚  â”‚ EQUAL    â”‚                    â”‚
                                   â”‚  â”‚  â”‚          â”‚ save()             â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”¼â”€â”€â”¼â”€â”      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ SMALLER    â”‚  â”‚ â”‚
                         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜  â”‚ â”‚
                    â”Œâ”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â–¼â”â”‚
                    â”‚ Reduceâ”‚  â”‚ Delete &  â”‚â”‚
                    â”‚ existingâ”‚ â”‚ Create   â”‚â”‚
                    â”‚ amount â”‚  â”‚ forward  â”‚â”‚
                    â”‚        â”‚  â”‚ balance  â”‚â”‚
                    â”‚ existingâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                    â”‚.amount-= â”‚  â”‚ Delete   â”‚
                    â”‚ new_amountâ”‚ existing  â”‚
                    â”‚        â”‚  â”‚          â”‚
                    â”‚ save() â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULT: Minimum balances maintained!
Balance optimized in O(1) time!
```

---

## Service Layer Communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CONTROLLER LAYER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Handles HTTP:                                              â”‚
â”‚  â€¢ Parse request                                            â”‚
â”‚  â€¢ Validate basic structure                                 â”‚
â”‚  â€¢ Call appropriate service                                 â”‚
â”‚  â€¢ Format response                                          â”‚
â”‚  â€¢ Handle errors                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      â”‚      â”‚       â”‚          â”‚
        â–¼      â–¼      â–¼       â–¼          â–¼
    â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Userâ”‚ â”‚Grp â”‚ â”‚Exp â”‚ â”‚Balanceâ”‚ â”‚Settlementâ”‚
    â”‚Srv â”‚ â”‚Srv â”‚ â”‚Srv â”‚ â”‚ Srv   â”‚ â”‚  Srv     â”‚
    â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚      â”‚ â”‚       â”‚
             â”‚      â”‚ â”‚       â””â”€â”€â”€â”€â”€â”
             â”‚      â”‚ â””â”€â”€â”€â”€â”€â”       â”‚
             â”‚      â”‚       â”‚       â”‚
             â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚       â”‚       â”‚    â”‚        â”‚
                    â–¼       â–¼       â–¼    â–¼        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ UTILS    â”‚  â”‚ MODELS  â”‚  â”‚ CONFIG  â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚Split calcâ”‚  â”‚Mongoose â”‚  â”‚MongoDB  â”‚
            â”‚No DB ops â”‚  â”‚Schemas  â”‚  â”‚connect  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚              â”‚           â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  MONGODB     â”‚
                         â”‚  Database    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Transformation Example

### Before & After Adding Expense

```
BEFORE:
â•â•â•â•â•â•â•
Users:
  - Alice (id: A1)
  - Bob (id: B1)

Groups:
  - Trip (id: G1) â†’ members: [A1, B1]

Expenses:
  - (empty)

Balances:
  - (empty)


REQUEST:
POST /expenses
{
  "groupId": "G1",
  "title": "Hotel",
  "paidBy": "A1",
  "amount": 300,
  "participants": ["A1", "B1"],
  "splitType": "EQUAL"
}


AFTER:
â•â•â•â•â•â•
Users:
  - Alice (id: A1)
  - Bob (id: B1)

Groups:
  - Trip (id: G1) â†’ members: [A1, B1]
  (unchanged)

Expenses:
  - Hotel (id: E1) {
      groupId: G1,
      paidBy: A1,
      amount: 300,
      participants: [A1, B1],
      splitType: EQUAL
    }

Balances:
  - BalanceRecord {
      groupId: G1,
      fromUser: B1,
      toUser: A1,
      amount: 150
    }
  â†‘
  â””â”€ NEW! System calculated: Bob owes Alice $150


EFFECT:
User can now call GET /balances/G1 and see:
"Bob owes Alice $150"
```

---

## Split Type Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SPLIT TYPE COMPARISON                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Type   â”‚   Input      â”‚   Calculation â”‚   Example (100)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EQUAL    â”‚ # participantsâ”‚ amount / countâ”‚ 100 / 4 = 25 each   â”‚
â”‚          â”‚              â”‚               â”‚                     â”‚
â”‚ EXACT    â”‚ exact amounts â”‚ use as-is     â”‚ {A:40, B:35, C:25} â”‚
â”‚          â”‚ (must sum)   â”‚ (validate sum)â”‚                     â”‚
â”‚          â”‚              â”‚               â”‚                     â”‚
â”‚ PERCENT  â”‚ percentages  â”‚ amount *      â”‚ 100 * [40%, 35%,   â”‚
â”‚          â”‚ (0-100)      â”‚ percent / 100 â”‚ 25%] = [40,35,25]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

EFFORT FOR USER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EQUAL: Least effort â†’ Just count people    â”‚
â”‚ EXACT: Most effort â†’ Specify each amount   â”‚
â”‚ PERCENT: Medium â†’ Specify percentages      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Hierarchy

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ REQUEST RECEIVED   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ROUTE VALIDATION   â”‚
                    â”‚ (URL, method)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ CONTROLLER VALIDATIONâ”‚
                    â”‚ (JSON parse, types) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ SERVICE VALIDATION  â”‚
                    â”‚ (business rules)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ DATABASE VALIDATION â”‚
                    â”‚ (schema, constraints)
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ OPERATION EXECUTION â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ SUCCESS RESPONSE   â”‚
                    â”‚ (201/200 OK)       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ERRORS CAN OCCUR AT ANY LEVEL
Each layer catches and returns appropriate HTTP status codes
```

---

## Performance Profile

```
                        TIME COMPLEXITY
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Create User:           O(1)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Single insert
â”‚
â”œâ”€ Validation: O(1)
â”œâ”€ Create: O(1)
â””â”€ Response: O(1)


Create Group:          O(1)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Single insert
â”‚
â”œâ”€ Validation: O(1)
â”œâ”€ Create: O(1)
â””â”€ Response: O(1)


Add Expense:           O(n)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ n = participants
â”‚
â”œâ”€ Group validation: O(1)
â”œâ”€ Participant validation: O(n)
â”œâ”€ Create expense: O(1)
â”œâ”€ Calculate split: O(n)  â—„â”€ Linear in participants
â”œâ”€ Update balances: O(n * 3) = O(n)
â”‚  â””â”€ 3 queries max per participant
â””â”€ Response: O(1)


Settlement:            O(1)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Single query/update
â”‚
â”œâ”€ Find balance: O(1)
â”œâ”€ Validate: O(1)
â”œâ”€ Update/Delete: O(1)
â””â”€ Response: O(1)


Get Balances:          O(m)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ m = balances in group
â”‚
â”œâ”€ Query: O(m)
â”œâ”€ Populate: O(m)
â””â”€ Response: O(1)


                        SPACE COMPLEXITY
                        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

All operations:        O(1)    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Constant space
                               No temp collections
                               No recursive calls
```

---

## Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DEVELOPMENT                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  $ npm run dev                                              â”‚
â”‚  â†“                                                           â”‚
â”‚  ts-node-dev (hot reload)                                   â”‚
â”‚  â†“                                                           â”‚
â”‚  localhost:5000                                             â”‚
â”‚  â†“                                                           â”‚
â”‚  MongoDB (local or Atlas)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PRODUCTION                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  $ npm run build      (TypeScript â†’ JavaScript)             â”‚
â”‚  $ npm start          (Node runs JavaScript)                â”‚
â”‚  â†“                                                           â”‚
â”‚  Express Server (compiled /dist)                            â”‚
â”‚  â†“                                                           â”‚
â”‚  [Load Balancer] â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                          â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â–¼           â–¼           â–¼           â–¼                     â”‚
â”‚ Server-1  Server-2  Server-3  Server-4                     â”‚
â”‚  (Node)    (Node)    (Node)    (Node)                      â”‚
â”‚  :5000     :5000     :5000     :5000                       â”‚
â”‚                                                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                â”‚        â”‚        â”‚                          â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                         â–¼                                    â”‚
â”‚                 MongoDB Cluster                             â”‚
â”‚                 (Primary + Replicas)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Visual Architecture Reference Complete**
